<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
  <meta charset="UTF-8" />
  <title>Meglytics | Dashboard</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="description" />
  <meta content="" name="author" />
  <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
  <!-- GLOBAL STYLES -->
  <link rel="stylesheet" href="dashboard/css/bootstrap.css" />
  <link rel="stylesheet" href="dashboard/css/main.css" />
  <link rel="stylesheet" href="dashboard/css/theme.css" />
  <link rel="stylesheet" href="dashboard/css/MoneAdmin.css" />



  <link rel="stylesheet" type="text/css" href="assets/css/keen-dashboards.css" />
  <link href="assets/css/simple-sidebar.css" rel="stylesheet">


  <link href="dashboard/fonts/css/font-awesome.min.css" rel="stylesheet">
  <!--END GLOBAL STYLES -->
  <!-- PAGE LEVEL STYLES -->
  <link href="dashboard/css/layout2.css" rel="stylesheet" />
  <link href="dashboard/css/mconnect-styles.css" rel="stylesheet" />
  <!-- END PAGE LEVEL  STYLES -->
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <style>
    #contextMenu {
      display: none;
      left: 100% !important;
      top: 5% !important;
      position: absolute;
      z-index: 99999;
    }
  </style>
</head>
<!-- END HEAD -->
<!-- BEGIN BODY -->

<body class="padTop53 ">
  <!-- MAIN WRAPPER -->
  <div id="wrap">
    <!-- HEADER SECTION -->
    <div id="top">
      <nav class="navbar navbar-inverse navbar-fixed-top " style="padding-top: 10px;">
        <a data-original-title="Show/Hide Menu" data-placement="bottom" data-tooltip="tooltip" class="accordion-toggle btn btn-primary btn-sm visible-xs" data-toggle="collapse" href="#menu" id="menu-toggle"> <i class="icon-align-justify"></i> </a>
        <!-- LOGO SECTION -->
        <header class="navbar-header">
          <a href="index.html" class="navbar-brand">
            <img src="images/logo.png" alt="" /> </a>
        </header>
        <!-- END LOGO SECTION -->
        <ul class="nav navbar-top-links navbar-right">
          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <span class="pull-left addrs-pro">Welcome back Arjun!</span>
              <!--<img class="img-circle" width="30" src="assets/img/user.gif"  alt="">--><i class="fa fa-circle pro-cirle"></i>&nbsp; <i class="fa fa-sort-desc pull-right pro-arws"></i> </a>
            <ul class="dropdown-menu dropdown-user">
              <li>
                <a href="#"><i class="icon-user"></i> User Profile </a>
              </li>
              <li>
                <a href="#"><i class="icon-gear"></i> Settings </a>
              </li>
              <li class="divider"></li>
              <li>
                <a href="login.html"><i class="icon-signout"></i> Logout </a>
              </li>
            </ul>
          </li>
          <!--END ADMIN SETTINGS -->
        </ul>
      </nav>
    </div>
    <!-- END HEADER SECTION -->
    <!-- MENU SECTION -->
    <!--END MENU SECTION -->
    <!--PAGE CONTENT -->
    <div id="">
      <div class="inner" style="min-height: 700px;">
        <!--     <div style="width:100%; height:auto; min-height:50px; background:#F5F5F5;"></div>-->

        <div class="container1">
          <div class="top-warps">
            <div class="col-sm-2">
              <a data-toggle="modal" role="button" class="btn btn-success" data-target="#exampleModal">New Dashboard</a>
            </div>
            <div class="col-sm-10">
              <div class="scroller scroller-left">
                <i class="fa fa-chevron-left"></i>
              </div>
              <div class="scroller scroller-right">
                <i class="fa fa-chevron-right"></i>
              </div>
              <div class="wrapper">
                <ul id="pageTab" class="nav nav-tabs list">
                  <li class="active">
                    <a href="#page1" data-toggle="tab">New Dash</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div id="pageTabContent" class="tab-content">
            <div class="tab-pane active" id="page1">
              <div class="">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 bhoechie-tab-container">
                  <div class="col-lg-2 col-md-3 col-sm-3 col-xs-5 bhoechie-tab-menu">
                    <div id="contextMenu" class="dropdown clearfix">
                      <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu" style="display:block;position:static;margin-bottom:5px;">
                        <li>
                          <a tabindex="-1" href="#">
                            <span>
                              <img src="images/dash-1.png" alt="">
                            </span>My SQL</a>
                        </li>
                        <li>
                          <a tabindex="-1" href="#">
                            <span>
                              <img src="images/dash-2.png" alt="">
                            </span>Windows</a>
                        </li>
                        <li>
                          <a tabindex="-1" href="#">
                            <span>
                              <img src="images/dash-3.png" alt="">
                            </span>Excel (.xls)</a>
                        </li>

                        <li>
                          <a tabindex="-1" href="#">
                            <span>
                              <img src="images/dash-4.png" alt="">
                            </span>Contact (.csv)</a>
                        </li>
                      </ul>
                    </div>

                    <div class="list-group">
                      <a href="#" class="list-group-item active text-center">
                        <h4 class="fa fa-floppy-o"></h4> Save </a>
                      <a href="#" class="list-group-item text-center">
                        <h4 class="fa fa-line-chart"></h4> M-Connect</a>

                      <h5>My-Dashboards</h5>
                      <table width="88%" border="0" cellspacing="0" cellpadding="0" align="center">
                        <tr style="background:#E9E9E9">
                          <td align="center" style="background:#E9E9E9">COLOUMN 1</td>
                          <td align="center" style="background:#E9E9E9">COLOUMN 2</td>
                        </tr>
                        <tr>
                          <td align="center"><a href="#" data-toggle="modal" data-target="#myModalHorizontal">CONTENT 1</a></td>
                          <td align="center"><a href="#" data-toggle="modal" data-target="#myModalNorm">CONTENT  2</a></td>
                        </tr>
                        <tr>
                          <td align="center">CONTENT 3</td>
                          <td align="center">CONTENT 4</td>
                        </tr>
                      </table>

                      <!-- Button trigger modal -->

                      <!-- Modal -->
                      <div id="exampleModal" class="modal fade" role="dialog">
                        <div class="modal-dialog">

                          <!-- Modal content-->
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal" data-dismiss="modal">
                                &times;
                              </button>
                              <h4 class="modal-title">New Dashboard</h4>
                            </div>
                            <div class="modal-body">
                              <div class="row">
                                <div class="col-md-4">
                                  <label >Query</label>
                                  <input type="text" name="host" id="query">
                                </div>
                                <div class="col-md-4 toppad" >
                                  <div class="dropdown">
                                    <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
                                      Dropdown Example
                                      <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu" id="modal_select">
                                      <li>
                                        <a href="#" id="modal_area">Area</a>
                                      </li>
                                      <li>
                                        <a href="#" id="modal_pie">Pie</a>
                                      </li>
                                      <li>
                                        <a href="#" id="modal_bar">Bar</a>
                                      </li>
                                      <li>
                                        <a href="#" id="modal_line">Line</a>
                                      </li>
                                      <li>
                                        <a href="#" id="modal_geo">Geo</a>
                                      </li>
                                      <li>
                                        <a href="#" id="modal_column">Column</a>
                                      </li>
                                      <li>
                                        <a href="#" id="modal_table">Table</a>
                                      </li>
                                    </ul>
                                  </div>
                                </div>
                                <div class="col-md-4">

                                  <button type="button" class="btn btn-default toppad" id="analyze">
                                    Analyze
                                  </button>
                                </div>
                              </div>
                              <div id="modal_chart" style="width: 300px; height: 300px;"></div>

                              <!-- </form> -->
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-default" data-dismiss="modal">
                                Close
                              </button>
                              <button type="button" id="save" class="btn btn-default" data-dismiss="modal">
                                Save
                              </button>
                            </div>
                          </div>

                        </div>
                      </div>

                      <!-- Button trigger modal -->
                      <!-- Modal -->
                      <div class="modal fade" id="myModlNorm" tabindex="-1" role="dialog" aria-labelledby="myModlLabel" aria-hidden="true">
                        <div class="modl-dialog">
                          <div class="modl-content">
                            <!-- Modal Header -->
                            <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">&times;</span>
                                <span class="sr-only">Close</span>
                              </button>
                              <h4 class="modal-title" id="myModalLabel"> New M Coonect </h4>
                            </div>

                            <!-- Modal Body -->
                            <div class="modal-body">
                              <form class="form-horizontal">
                                <div class="form-group">
                                  <label class="col-sm-4 control-label text-right" for="inputEmail3">Name</label>
                                  <div class="col-sm-8">
                                    <input type="email" class="form-control" id="inputEmail3" placeholder="Name" />
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-offset-4 col-sm-6">
                                    <button type="submit" class="btn btn-success">
                                      Create
                                    </button>
                                  </div>
                                </div>
                              </form>
                            </div>

                            <!-- Modal Footer -->

                          </div>
                        </div>
                      </div>
                      <!-- Post Info -->
                    </div>
                  </div>
                  <div id="wrapper">

                    <!--  <div id="page-content-wrapper"> -->
                    <div class="col-sm-6">
                      <div class="chart-wrapper ">
                        <div class="chart-title">
                          Chart-1
                        </div>
                        <div class="chart-stage">
                          <div id="chart1" style="width: 500px; height: 300px;"></div>
                        </div>

                      </div>
                    </div>

                    <div class="col-sm-6 ">
                      <div class="chart-wrapper">
                        <div class="chart-title">
                          Chart-2
                        </div>
                        <div id="chart2" style="width: 500px; height: 330px;"></div>
                      </div>
                    </div>

                    <div class="col-sm-6 ">
                      <div class="chart-wrapper">
                        <div class="chart-title">
                          Chart-3
                        </div>
                        <div class="chart-stage">
                          <div id="chart3" style="width: 500px; height: 330px;"></div>
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-6 ">
                      <div class="chart-wrapper">
                        <div class="chart-title">
                          Chart-4
                        </div>
                        <div class="chart-stage">
                          <div id="chart4" style="width: 500px; height: 330px;"></div>
                        </div>
                      </div>
                    </div>


                    <div class="col-sm-6 ">
                      <div class="chart-wrapper">
                        <div class="chart-title">
                          Chart-5
                        </div>
                        <div class="chart-stage">
                          <div id="chart5" style="width: 100px; height: 330px;"></div>
                        </div>
                      </div>
                    </div>


                    <div class="col-sm-6 ">
                      <div class="chart-wrapper">
                        <div class="chart-title">
                          Chart-6
                        </div>
                        <div class="chart-stage">
                          <div id="chart6" style="width: 100px; height: 330px;"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--BLOCK SECTION -->
        <!--END BLOCK SECTION -->
        <hr />
      </div>
    </div>

  </div>
  <!--END MAIN WRAPPER -->
  <!-- FOOTER -->

  <!--END FOOTER -->
  <!-- GLOBAL SCRIPTS -->
  <script src="js/jquery-2.2.0.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/bootstrap-filestyle.js"></script>


  <!-- END PAGE LEVEL SCRIPTS -->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <!-- KEEN dash -->
  <script type="text/javascript" src="assets/lib/holderjs/holder.js"></script>
  <script>
    Holder.add_theme("white", {
      background: "#fff",
      foreground: "#a7a7a7",
      size: 10
    });
  </script>

  <!--SCRIPTS END-->

  <script type="text/javascript">
    localStorage.setItem("workbench", "fooWorkbench") //NOTE: THIS WILL BE REMOVED AND WORKBENCH WILL BE STORED IN MCONNECT
    var chart_selected = '';
    var chartObjs = {};
    var ndata = '';
    var query = '';
    var wb = localStorage.getItem("workbench");

    var count = "count";
    var inc = 0;
    var ctxs = ["chart1", "chart2", "chart3", "chart4", "chart5", "chart6"];
    localStorage.setItem(count, inc);

    google.charts.load('current', {
      'packages': ['corechart', 'table']
    });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      initModalCharts();
    }

    function transpose(a) {
      return a[0].map(function(_, c) {
        return a.map(function(r) {
          return r[c];
        });
      });
    }
    //init modal charts with dummy data
    function initModalCharts() {
      var init_data = [
        ['Year', '2014', '2015', '2014', '2013'],
        ['Expenses', 800, 600, 400, 110],
        ['Sales', 100, 1170, 555, 1123]
      ];

      var t_data = transpose(init_data);

      var data = google.visualization.arrayToDataTable(t_data);
      //  var ndata = '';
      // Set chart options
      /*  var options = {
          'title': 'How Much Line chart willi draw?',
          'width': 450,
          'height': 300
        }; */

      var options = {
        'title': 'MeglyticsBI',
        'width': 475,
        'height': 350
      };


      chartObjs["BarChart"] = new google.visualization.BarChart(document.getElementById('modal_chart'));
      chartObjs["PieChart"] = new google.visualization.PieChart(document.getElementById('modal_chart'));
      chartObjs["AreaChart"] = new google.visualization.AreaChart(document.getElementById('modal_chart'));
      chartObjs["LineChart"] = new google.visualization.LineChart(document.getElementById('modal_chart'));
      chartObjs["GeoChart"] = new google.visualization.GeoChart(document.getElementById('modal_chart'));
      chartObjs["ColumnChart"] = new google.visualization.ColumnChart(document.getElementById('modal_chart'));
      chartObjs["Table"] = new google.visualization.Table(document.getElementById('modal_chart'));



      $("#modal_area").click(function() {
        chart_selected = 'AreaChart'
        new google.visualization.AreaChart(document.getElementById('modal_chart')).draw(data, options);

        //  chartObjs[chart_selected].draw(data, options);
      });

      $("#modal_pie").click(function() {
        chart_selected = 'PieChart'
        new google.visualization.PieChart(document.getElementById('modal_chart')).draw(data, options);
        //  chartObjs[chart_selected].draw(data, options);
      });

      $("#modal_bar").click(function() {
        chart_selected = 'BarChart'
        new google.visualization.BarChart(document.getElementById('modal_chart')).draw(data, options);

        //chartObjs[chart_selected].draw(data, options);
      });

      $("#modal_line").click(function() {
        chart_selected = 'LineChart'
        new google.visualization.LineChart(document.getElementById('modal_chart')).draw(data, options);

        //chartObjs[chart_selected].draw(data, options);
      });

      $("#modal_geo").click(function() {
        chart_selected = 'GeoChart'
        new google.visualization.GeoChart(document.getElementById('modal_chart')).draw(data, options);

        //chartObjs[chart_selected].draw(data, options);
      });

      $("#modal_column").click(function() {
        chart_selected = 'ColumnChart'
        new google.visualization.ColumnChart(document.getElementById('modal_chart')).draw(data, options);

        //chartObjs[chart_selected].draw(data, options);
      });

      $("#modal_table").click(function() {
        chart_selected = 'Table'
        new google.visualization.Table(document.getElementById('modal_chart')).draw(data, options);

        //  chartObjs[chart_selected].draw(data, options);
      });


      $("#analyze").click(function() {
        query = $("#query").val();
        var d = getQueryData(query);

        ndata = new google.visualization.arrayToDataTable(d);
        chartObjs[chart_selected].draw(ndata, options);
      });

      $("#save").click(function() {
        var no = check();
        var id = ctxs[no];


        var cs = getChartObject(chart_selected, id);

          cs.draw(ndata, options);

      });
    }

    function getChartObject(c, id) {

      switch (c) {
        case 'AreaChart':
          return new google.visualization.AreaChart(document.getElementById(id));
          break;
        case 'PieChart':
          return new google.visualization.PieChart(document.getElementById(id));
          break;
        case 'BarChart':
          return new google.visualization.BarChart(document.getElementById(id));
          break;
        case 'LineChart':
          return new google.visualization.LineChart(document.getElementById(id));
          break;
        case 'GeoChart':
          return new google.visualization.GeoChart(document.getElementById(id));
          break;
        case 'ColumnChart':
          return new google.visualization.ColumnChart(document.getElementById(id));
          break;
          case 'Table':
            return new google.visualization.Table(document.getElementById(id));
            break;
      }

    };

    function getQueryData(query) {

      var dd = [];

      $.ajax({
        type: 'POST',
        url: '/workbench',
        async: false,
        data: {
          "query": query,
          "email": "tset",
          "password": "pass",
        },
        dataType: "json",
        success: function(data) {
          dd = data;
        }
      });

      return transpose(dd)

    };

    function check() {
      //if goes exceeds more than 4, reset it to 1
      var c = localStorage.getItem(count);
      var cnt = parseInt(c);
      if (c != 5) {
        cnt++;
        localStorage.setItem(count, cnt)
        return c
      } else if (c == 5) {
        localStorage.setItem(count, 0)
        return c
      }
    };

    $("#report").click(function() {
      $.ajax({
        type: 'GET',
        url: '/report',
        async: false,
      });
    });
  </script>
</body>
<!-- END BODY -->

</html>
